{% extends "user/base.html" %}

{% block title %} Order Successful {% endblock %}

{% block extra_head %}
<style>
    .success-container {
        width: 55%;
        margin: auto;
        padding: 20px;
        text-align: center;
        border: 1px solid #ddd;
        border-radius: 10px;
        margin-top: 40px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        background: linear-gradient(169deg, rgb(227, 248, 255) 0%, whitesmoke 80%);
    }

    .success-container h2 {
        color: green;
    }

    .order-details {
        text-align: left;
        margin-top: 20px;
        line-height: 1.6;
    }

    .items-list {
        margin-top: 20px;
    }

    .items-list table {
        width: 100%;
        border-collapse: collapse;
    }

    .items-list table,
    th,
    td {
        border: 1px solid #ccc;
    }

    th,
    td {
        padding: 10px;
    }

    .btn {
        padding: 10px 15px;
        background-color: #0077ff;
        color: #fff;
        border-radius: 5px;
        text-decoration: none;
        margin-right: 10px;
    }

    .btn:hover {
        background-color: #08bb38;
    }

    /* -----------------------------------------
   Order Successful â€” Mobile panel responsive
   (paste at bottom of your external style.css)
   Applies only on screens <= 767.98px
   ----------------------------------------- */
    @media (max-width: 767.98px) {

        /* Container becomes panel-friendly: full width with small inset padding */
        .success-container {
            width: calc(100% - 28px) !important;
            /* full width with small gutters */
            margin: 12px auto !important;
            padding: 12px !important;
            border-radius: 10px !important;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.14) !important;
            background: linear-gradient(189deg, rgb(227, 248, 255) 0%, whitesmoke 90%) !important;
        }

        .success-container h2 {
            font-size: 18px !important;
            margin-bottom: 6px !important;
        }

        .success-container p {
            font-size: 14px !important;
            margin: 6px 0 !important;
        }

        /* Order details: tighten spacing */
        .order-details {
            margin-top: 25px !important;
            line-height: 1.4 !important;
            font-size: 13.5px !important;
        }

        .order-details p {
            margin: 6px 0 !important;
            padding-left: 12px;
        }

        /* Items-list: convert table to stacked rows for readability on mobile */
        .items-list table {
            width: 100% !important;
            border-collapse: separate !important;
        }

        /* Hide native table header for stacked presentation */
        .items-list table th {
            display: none !important;
        }

        /* Each table row becomes a stacked card */
        .items-list table tbody tr {
            display: flex !important;
            flex-direction: column !important;
            gap: 8px !important;
            padding: 10px !important;
            margin-bottom: 8px !important;
            border: 1px solid rgba(0, 0, 0, 0.06) !important;
            border-radius: 8px !important;
            background: rgba(255, 255, 255, 0.95) !important;
        }

        /* Make table cells behave like label: value pairs */
        .items-list table tbody tr td {
            display: flex !important;
            justify-content: space-between !important;
            padding: 6px 8px !important;
            font-size: 13px !important;
            border: none !important;
        }

        /* Add subtle label before values using :before (non-invasive) */
        .items-list table tbody tr td:first-child::before {
            content: "Product: ";
            font-weight: 600;
            margin-right: 6px;
        }

        .items-list table tbody tr td:nth-child(2)::before {
            content: "Qty: ";
            font-weight: 600;
            margin-right: 6px;
        }

        .items-list table tbody tr td:nth-child(3)::before {
            content: "Price: ";
            font-weight: 600;
            margin-right: 6px;
        }

        /* Buttons: make them full width and stacked */
        .success-container .btn {
            display: block !important;
            width: 100% !important;
            box-sizing: border-box !important;
            margin: 8px 0 !important;
            padding: 12px 14px !important;
            font-size: 15px !important;
            text-align: center !important;
        }

        /* Slight color tweak to keep primary/secondary contrast on mobile */
        .success-container .btn:hover {
            transform: translateY(-1px);
        }

        /* Reduce table fonts slightly for dense lists */
        .items-list table td,
        .items-list table th {
            font-size: 13px !important;
        }

        /* Keep the container scrollable inside a mobile panel if needed */
        .success-container {
            max-height: calc(100vh - 110px);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
    }
</style>
{% endblock %}

{% block content %}

<div class="success-container">

    <h2>ðŸŽ‰ Your Order is Confirmed!</h2>
    <p><i class="fa-solid fa-handshake"></i> Thank you for shopping with <strong>SmartCart</strong>.</p>

    <div class="order-details">
        <p><strong>Order ID:</strong> {{ order.order_id }}</p>
        <p><strong>Payment ID:</strong> {{ order.razorpay_payment_id }}</p>
        <p><strong>Amount Paid:</strong> â‚¹{{ order.amount }}</p>
        <p><strong>Order Date:</strong> {{ order.created_at }}</p>
    </div>

    <div class="items-list">
        <h3>Order Summary</h3>

        <table>
            <tr>
                <th>Product</th>
                <th>Qty</th>
                <th>Price (â‚¹)</th>
            </tr>

            {% for it in items %}
            <tr>
                <td>{{ it.product_name }}</td>
                <td>{{ it.quantity }}</td>
                <td>{{ it.price }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>

    <br>

    <a href="/user/products" class="btn">Continue Shopping <i class="fa-solid fa-cart-arrow-down"></i></a>
    <a href="/user/my-orders" class="btn">View My Orders <i class="fa-solid fa-truck-ramp-box"></i></a>
    <a href="/user/download-invoice/{{ order.order_id }}" class="btn">Download Invoice (PDF) <i
            class="fa-solid fa-download"></i></a>


</div>

{% endblock %}